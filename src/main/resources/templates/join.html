<!DOCTYPE html>
<html lang="ko">

<head xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
  <meta charset="utf-8">
  <title>UKIDS | 회원가입</title>
  <!-- SEO Meta Tags-->
  <meta name="description" content="Cartzilla - Bootstrap E-commerce Template">
  <meta name="keywords"
    content="bootstrap, shop, e-commerce, market, modern, responsive,  business, mobile, bootstrap, html5, css3, js, gallery, slider, touch, creative, clean">
  <meta name="author" content="Createx Studio">
  <!-- Viewport-->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon and Touch Icons-->
  <link rel="apple-touch-icon" sizes="180x180" th:href="@{/img/ukids/logo.jpg}">
  <link rel="icon" type="image/png" sizes="32x32" th:href="@{/img/ukids/logo.jpg}">
  <link rel="icon" type="image/png" sizes="16x16" th:href="@{/img/ukids/logo.jpg}">
  <link rel="manifest" href="site.webmanifest">
  <link rel="mask-icon" color="#fe6a6a" th:href="@{/safari-pinned-tab.svg}">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">
  <!-- Vendor Styles including: Font Icons, Plugins, etc.-->
  <link rel="stylesheet" media="screen" th:href="@{/vendor/simplebar/dist/simplebar.min.css}" />
  <link rel="stylesheet" media="screen" th:href="@{/vendor/tiny-slider/dist/tiny-slider.css}" />
  <link rel="stylesheet" media="screen" th:href="@{/vendor/drift-zoom/dist/drift-basic.min.css}" />
  <link rel="stylesheet" media="screen" th:href="@{/vendor/lightgallery.js/dist/css/lightgallery.min.css}" />
  <!-- Main Theme Styles + Bootstrap-->
  <link rel="stylesheet" media="screen" th:href="@{/css/theme.min.css}">
  <link rel="stylesheet" media="screen" th:href="@{/css/cgw.css}">
  <link rel="stylesheet" media="screen" th:href="@{/css/header.css}">
  <link rel="stylesheet" media="screen" th:href="@{/css/footer.css}">

  <!--jquery-->
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="js/join.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

  <!-- 폰트 -->
  <style>
    @font-face {
      font-family: 'NanumSquareRound';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/NanumSquareRound.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }

    * {
      font-family: 'NanumSquareRound';
    }
    
    .form-check-input:checked {
      background-color: #fc6c93;
  }
     .kakaoEnroll:hover{
      opacity: 80%;
    }
    
  </style>

</head>

<!-- Body-->

<body class="handheld-toolbar-enabled">

  <!-- 로그인 모달 관련  -->
 <div th:fragment="modal" th:replace="~{common :: modal}"></div>

  <main class="page-wrapper">

    <!-- 헤더!!!!!! -->
    <header th:fragment="header" th:replace="~{common :: header}"></header>
    <!-- 헤더 끝 -->
    <!-- Page Title-->
    <div class="bg-position-top-center bg-repeat-0 py-5 bg-dark-cgw3">
      <div class="pt-0 pb-5">
        <div class="container pt-0  pt-lg-0">
          <div class="mb-3 mb-lg-0 pt-lg-0">
            <nav aria-label="breadcrumb">
              <ol
                class="breadcrumb breadcrumb-light fw-bold fs-md flex-lg-nowrap justify-content-center justify-content-lg-end">
                <li class="breadcrumb-item"><a class="text-nowrap" href="index.html"><i class="ci-home"></i>유키즈</a></li>
                <li class="breadcrumb-item text-nowrap cgw3" aria-current="page">회원가입</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <div class="container pb-5 mb-2 mb-md-4 cgw1">
      <div class="container py-4 py-lg-5 my-4">
        <div class="row">
          <div class="col-md-12">
            <div class="card border-0 shadow">
              <div class="card-body">
                <h2 class="h4 mb-3 ms-5 mt-2">회원가입</h2>
                <hr>
                <form class="needs-validation mt-3 ms-3" th:action="@{/member/enroll}" method="post" onsubmit="return submitCheck();">
                  <div class="product-details-cgw pb-3 cgw16 ms-5 mt-4 border-end">
                    <div class="col-sm-10">
                      <label class="form-label" for="account-fn">아이디</label><br>
                      <th:block th:if="${kakaoMap == null}">
                      <input type="hidden" name="kakaoToken">
                      </th:block>
                      <th:block th:if="${kakaoMap != null}">
                      <input type="hidden" name="kakaoToken" th:value="${kakaoMap.id}">
                      </th:block>
                      
                      <th:block th:if="${kakaoMap == null}">
                      <input class="form-control-cgw2" type="text" name="id" id="newId" placeholder="아이디 (4글자 이상)" required>
                      </th:block>
                      <th:block th:if="${kakaoMap != null}">
                      <input class="form-control-cgw2" type="text" name="id" id="newId" placeholder="아이디 (4글자 이상)" th:value="${kakaoMap.email}" required>
                      </th:block>
                      <button class="btn btn-primary-cgw2 btn-sm mx-4" type="button" id="checkDuplicate" value="중복검사">중복확인</button>
                    </div>
                    
                    <div class="col-sm-9">
                      <label class="form-label" for="name">이름</label>
                      <th:block th:if="${kakaoMap == null}">
                      <input class="form-control-cgw1" type="text" name="name" id="name" placeholder="이름을 입력해 주세요.">
                      </th:block>
                      <th:block th:if="${kakaoMap != null}">
                      <input class="form-control-cgw1" type="text" name="name" id="name" th:value="${kakaoMap.nickname}" required>
                      </th:block>
                      
                    </div>
                    <div class="col-sm-9">
                      <label class="form-label" for="account-pass">비밀번호</label>
                      <div class="password-toggle">
                        <input class="form-control" type="password" name="password" id="password1" placeholder="비밀번호는 4자 이상 20자 이하만 가능합니다.">
                      </div>
                    </div>
                    <div class="col-sm-9">
                      <label class="form-label" for="password2">비밀번호 확인</label>
                      <div class="password-toggle">
                        <input class="form-control" type="password" id="password2">
                      </div>
                    </div>
                    <div class="col-sm-9">
                      <label class="form-label" for="account-email">이메일</label>
                      <input class="form-control-cgw1" type="text" name="email" id="account-email" placeholder="ukids@example.com">
                    </div>
                    <div class="col-sm-9">
                      <label class="form-label" for="account-phone">연락처</label>
                      <input class="form-control-cgw1" type="text" name="phone" id="account-phone" placeholder="010-0000-0000">
                    </div>
                    <div class="col-sm-9">
                      <label class="form-label" for="account-address">주소</label>
                      <div class="">
                        <input class="form-control-postcode" type="text" name="postCode" id="addressPostcode" placeholder="우편번호">
                        <input type="button" class="btn btn-primary-cgw2 btn-sm mx-4" value="우편번호 찾기"
                          onclick="kakaopost()">
                        <input class="form-control-cgw1" type="text" name="address" id="addressBasic" placeholder="주소">
                        <input class="form-control-cgw1" type="text" name="address2" id="addressDetail" placeholder="상세주소">
                      </div>
                    </div>
                  </div>
                  <div class="row gx-4 gy-3 product-details cgw10 me-5 mt-2">
                  	<h2 class="h4">회원 유형을 선택해주세요</h2>
					<div class="form-check form-check-inline d-lnline-block mt-0" style="margin-left: 10px; width: 150px;">
					  <input class="form-check-input" type="radio" id="user" name="role" value="ROLE_USER" checked>
					  <label class="form-check-label" for="user">일반회원(학부모)</label>
					</div>
					<div class="form-check form-check-inline d-lnline-block w-25 mt-0" style="float: left;">
					  <input class="form-check-input" type="radio" id="teacher" name="role" value="ROLE_T">
					  <label class="form-check-label" for="teacher">선생님</label>
					</div><hr>
                    <h2 class="h4 mb-0">일반회원이신가요?</h2>
                    <p class="fs-sm text-muted mb-0">일반회원입력란입니다. (선택입력 사항입니다.)</p>
                    <br>
                    <div class="col-sm-12 mb-2">
                      <label class="form-label" for="account-childNum">자녀 수</label>&nbsp;
                      <input class="form-control-postcode mb-0" type="number" name="kidNum" id="account-childNum" value="0" min="0" max="3" 
                        required>&nbsp;&nbsp;&nbsp;명<br><br>
                      <label class="form-label" for="account-childAge">자녀 나이</label><br>
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="0세">&nbsp;
                        <label class="form-check-label" for="account-childAge">0</label >&nbsp;&nbsp;&nbsp;
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="1세">&nbsp;
                        <label class="form-check-label" for="account-childAge">1</label>&nbsp;&nbsp;&nbsp;
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="2세">&nbsp;
                        <label class="form-check-label" for="account-childAge">2</label>&nbsp;&nbsp;&nbsp;
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="3세">&nbsp;
                        <label class="form-check-label" for="account-childAge">3</label>&nbsp;&nbsp;&nbsp;
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="4세">&nbsp;
                        <label class="form-check-label" for="account-childAge">4</label>&nbsp;&nbsp;&nbsp;
                        <input class="form-check-input" type="checkbox" name="kidAge" id="account-childAge" value="5세">&nbsp;
                        <label class="form-check-label" for="account-childAge">5</label>&nbsp;&nbsp;&nbsp;
                    </div>
                    <hr class="mt-0">
                    <h2 class="h4 mb-0 d-inline-block">선생님이신가요?</h2>
                    <p class="fs-sm text-muted mb-0">선생님입력란입니다. (필수입력 사항입니다.)</p>
                    <div class="col-sm-12">
                      <label class="form-label" for="checkout-country">소속</label>
                      <select class="form-select" name="field" id="checkout-country">
                      	<option value="없음">없음</option>
                        <option value="유치원">유치원</option>
                        <option value="어린이집">어린이집</option>
                      </select>
                    </div>
                    <div class="col-sm-12">
                      <label class="form-label" for="account-phone">소속 코드</label>
                      <input class="form-control-cgw1" type="text" name="fieldCd" id="account-phone">
                    </div>
                    <div class="col-12 text-end mb-2">
                      <a class="kakaoEnroll d-inline-block w-50 mx-1" th:href="@{https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=4f6893c26b967b74677e6e11e11210b6&redirect_uri=http://localhost/member/kakaoEnroll}"><img th:src="@{/img/ukids/9.png}"></a>
                      <button id="enrollSubmit" class="btn btn-primary-cgw1" type="submit"><i class="ci-user me-2 ms-n1"></i>회원가입</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>

        </div>
      </div>
  </main>
  <!-- 푸터!!!!!!!!!!-->
  <!-- Footer-->
	<footer th:fragment="footer" th:replace="~{common :: footer}"></footer>	


  <!-- Toolbar for handheld devices (Default)-->
  <div class="handheld-toolbar">
    <div class="d-table table-layout-fixed w-100"><a class="d-table-cell handheld-toolbar-item"
        href="account-wishlist.html"><span class="handheld-toolbar-icon"><i class="ci-heart"></i></span><span
          class="handheld-toolbar-label">Wishlist</span></a><a class="d-table-cell handheld-toolbar-item"
        href="javascript:void(0)" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
        onclick="window.scrollTo(0, 0)"><span class="handheld-toolbar-icon"><i class="ci-menu"></i></span><span
          class="handheld-toolbar-label">Menu</span></a><a class="d-table-cell handheld-toolbar-item"
        href="shop-cart.html"><span class="handheld-toolbar-icon"><i class="ci-cart"></i><span
            class="badge bg-primary rounded-pill ms-1">4</span></span><span
          class="handheld-toolbar-label">$265.00</span></a></div>
  </div>
  <!-- Back To Top Button--><a class="btn-scroll-top" href="#top" data-scroll><span
      class="btn-scroll-top-tooltip text-muted fs-sm me-2">Top</span><i class="btn-scroll-top-icon ci-arrow-up">
    </i></a>
  <!-- Vendor scrits: js libraries and plugins-->
  <script src="vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="vendor/simplebar/dist/simplebar.min.js"></script>
  <script src="vendor/tiny-slider/dist/min/tiny-slider.js"></script>
  <script src="vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script src="vendor/drift-zoom/dist/Drift.min.js"></script>
  <script src="vendor/lightgallery.js/dist/js/lightgallery.min.js"></script>
  <script src="vendor/lg-video.js/dist/lg-video.min.js"></script>

  <script src="vendor/flatpickr/dist/flatpickr.min.js"></script>
  <script src="vendor/flatpickr/dist/plugins/rangePlugin.js"></script>
  <!-- Main theme script-->
  <script src="js/theme.min.js"></script>

  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script>
    function kakaopost() {
      new daum.Postcode({
        oncomplete: function (data) {
          // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

          // 각 주소의 노출 규칙에 따라 주소를 조합한다.
          // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
          var fullAddr = ''; // 최종 주소 변수
          var extraAddr = ''; // 조합형 주소 변수

          // 사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
          if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
            fullAddr = data.roadAddress;

          } else { // 사용자가 지번 주소를 선택했을 경우(J)
            fullAddr = data.jibunAddress;
          }

          // 사용자가 선택한 주소가 도로명 타입일때 조합한다.
          if (data.userSelectedType === 'R') {
            //법정동명이 있을 경우 추가한다.
            if (data.bname !== '') {
              extraAddr += data.bname;
            }
            // 건물명이 있을 경우 추가한다.
            if (data.buildingName !== '') {
              extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
            }
            // 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
            fullAddr += (extraAddr !== '' ? ' (' + extraAddr + ')' : '');
          }

          // 우편번호와 주소 정보를 해당 필드에 넣는다.
          document.getElementById('addressPostcode').value = data.zonecode; //5자리 새우편번호 사용
          document.getElementById('addressBasic').value = fullAddr;

          // 커서를 상세주소 필드로 이동한다.
          document.getElementById('addressDetail').focus();
        }
      }).open();
    }
  </script>
  <script type="text/javascript">
	// 아이디 중복을 확인하는 AJAX 코드
	$("#checkDuplicate").on("click", () => {
		let id = $("#newId").val().trim();

		if (id.length < 4) {
			alert("아이디는 최소 4글자입니다.")
			return;
		}

		$.ajax({
			type: "get",
			url: "[[@{/member/idCheck}]]",
			data: { id }, // 속성값이 키값과 같은 이름을 가질때 하나로만 key-value 채운다.
			success:
				(data) => { // validate key값
					console.log(data);
					if (data.validate === true) {
						alert("이미 사용중인 아이디입니다.")
					} else {
						alert("사용 가능합니다.")
					}
				},
			error:
				(e) => {
					console.log(e);
				}
		});
	});

  </script>
</body>

</html>